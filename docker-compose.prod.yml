version: '3.8'

# Production override для docker-compose
# Использование: docker-compose -f docker-compose.yml -f docker-compose.prod.yml up -d
# 
# Примечание: Этот файл использует готовый образ из Docker Hub.
# Если образ не найден и нужна локальная сборка, раскомментируйте секцию build ниже
# и закомментируйте строку image.

services:
  nextjs:
    image: ${DOCKERHUB_USERNAME:-yourusername}/bartech:latest
    pull_policy: always
    # Для локальной сборки раскомментируйте следующую секцию:
    # build:
    #   context: .
    #   dockerfile: Dockerfile
    #   args:
    #     - NEXT_PUBLIC_SUPABASE_URL=${NEXT_PUBLIC_SUPABASE_URL}
    #     - NEXT_PUBLIC_SUPABASE_ANON_KEY=${NEXT_PUBLIC_SUPABASE_ANON_KEY}
    restart: always
    environment:
      - NODE_ENV=production
      - NEXT_PUBLIC_SUPABASE_URL=${NEXT_PUBLIC_SUPABASE_URL}
      - NEXT_PUBLIC_SUPABASE_ANON_KEY=${NEXT_PUBLIC_SUPABASE_ANON_KEY}

  nginx:
    restart: always

  certbot:
    restart: always

